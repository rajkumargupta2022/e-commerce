(()=>{var e={};e.id=146,e.ids=[146],e.modules={56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},29021:e=>{"use strict";e.exports=require("fs")},33873:e=>{"use strict";e.exports=require("path")},77935:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>A,routeModule:()=>q,serverHooks:()=>v,workAsyncStorage:()=>j,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{DELETE:()=>w,GET:()=>f,POST:()=>y});var o=t(42706),n=t(28203),i=t(45994),a=t(39187),u=t(72082),c=t(81755),p=t(29021),d=t.n(p),l=t(33873),g=t.n(l);async function m(e){if(!e)return null;let r=Buffer.from(await e.arrayBuffer()),t=Date.now()+"-"+e.name,s=g().join(process.cwd(),"public/uploads");return d().existsSync(s)||d().mkdirSync(s,{recursive:!0}),d().writeFileSync(g().join(s,t),r),t}async function y(e){try{await (0,c.A)();let r=await e.formData(),t=r.getAll("images");console.log("====== Received Files ======",t);let s=await Promise.all(t.map(e=>m(e))),o=new u.A({name:r.get("name"),category:r.get("category"),febricCategory:r.get("febricCategory"),price:r.get("price"),size:r.get("size"),description:r.get("description"),quantity:r.get("quantity"),color:r.get("color"),images:s});return await o.save(),a.NextResponse.json({msg:"Added successfully",success:!0},{status:201})}catch(e){return console.error("Error:",e),a.NextResponse.json({error:"Failed"},{status:500})}}async function f(){try{await (0,c.A)(),console.log("i am here");let e=await u.A.find();return a.NextResponse.json({success:!0,data:e},{status:200})}catch(e){return console.error("Error:",e),a.NextResponse.json({error:"Database error"},{status:500})}}function x(e){if(!e)return;let r=g().join(process.cwd(),"public/uploads",e);d().existsSync(r)&&d().unlinkSync(r)}async function w(e){try{await (0,c.A)();let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return a.NextResponse.json({error:"Product ID is required"},{status:400});let s=await u.A.findById(t);if(!s)return a.NextResponse.json({error:"Product not found"},{status:404});return x(s.image1),x(s.image2),await u.A.findByIdAndDelete(t),a.NextResponse.json({msg:"Product deleted successfully"},{status:200})}catch(e){return console.error("Error deleting product:",e),a.NextResponse.json({error:"Delete failed"},{status:500})}}require("console");let q=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"D:\\New folder\\app\\api\\products\\route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:j,workUnitAsyncStorage:h,serverHooks:v}=q;function A(){return(0,i.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:h})}},96487:()=>{},78335:()=>{},72082:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(56037),o=t.n(s);let n=new(o()).Schema({name:{type:String,required:!0},category:{type:String,required:!0},febricCategory:{type:String,required:!0},price:{type:Number,required:!0},size:{type:String,required:!0},images:{type:[String]},quantity:{type:Number,required:!0},description:{type:String},color:{type:String}}),i=o().models.Product||o().model("Products",n)},81755:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(56037),o=t.n(s);let n="mongodb://localhost:27017/lebel";if(!n)throw Error("Please define the MONGODB_URI");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let a=async function(){return i.conn||(i.promise||(i.promise=o().connect(n,{bufferCommands:!1}).then(e=>e)),i.conn=await i.promise),i.conn}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452],()=>t(77935));module.exports=s})();