(()=>{var e={};e.id=3146,e.ids=[3146],e.modules={56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},29021:e=>{"use strict";e.exports=require("fs")},33873:e=>{"use strict";e.exports=require("path")},91661:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>j,serverHooks:()=>v,workAsyncStorage:()=>q,workUnitAsyncStorage:()=>b});var s={};t.r(s),t.d(s,{DELETE:()=>w,GET:()=>f,POST:()=>y});var o=t(42706),n=t(28203),a=t(45994),i=t(39187),u=t(72082),c=t(81755),p=t(29021),d=t.n(p),l=t(33873),g=t.n(l);async function m(e){if(!e)return null;let r=Buffer.from(await e.arrayBuffer()),t=Date.now()+"-"+e.name,s=g().join(process.cwd(),"public/uploads");return d().existsSync(s)||d().mkdirSync(s,{recursive:!0}),d().writeFileSync(g().join(s,t),r),t}async function y(e){try{await (0,c.A)();let r=await e.formData(),t=r.getAll("images"),s=r.getAll("size"),o=await Promise.all(t.map(e=>m(e))),n=new u.A({name:r.get("name"),category:r.get("category"),febricCategory:r.get("febricCategory"),price:r.get("price"),size:s,description:r.get("description"),quantity:r.get("quantity"),color:r.get("color"),images:o});return await n.save(),i.NextResponse.json({msg:"Added successfully",success:!0},{status:201})}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Failed"},{status:500})}}async function f(){try{await (0,c.A)();let e=await u.A.find();return i.NextResponse.json({success:!0,data:e},{status:200})}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Database error"},{status:500})}}function x(e){if(!e)return;let r=g().join(process.cwd(),"public/uploads",e);d().existsSync(r)&&d().unlinkSync(r)}async function w(e){try{await (0,c.A)();let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return i.NextResponse.json({error:"Product ID is required"},{status:400});let s=await u.A.findById(t);if(!s)return i.NextResponse.json({error:"Product not found"},{status:404});return x(s.image1),x(s.image2),await u.A.findByIdAndDelete(t),i.NextResponse.json({msg:"Product deleted successfully"},{status:200})}catch(e){return console.error("Error deleting product:",e),i.NextResponse.json({error:"Delete failed"},{status:500})}}require("console");let j=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"/home/rajkumar/my-app/e-commerce/app/api/products/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:q,workUnitAsyncStorage:b,serverHooks:v}=j;function h(){return(0,a.patchFetch)({workAsyncStorage:q,workUnitAsyncStorage:b})}},96487:()=>{},78335:()=>{},72082:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(56037),o=t.n(s);let n=new(o()).Schema({name:{type:String,required:!0},category:{type:String,required:!0},febricCategory:{type:String,required:!0},price:{type:Number,required:!0},size:{type:[String],required:!0},images:{type:[String]},quantity:{type:Number,required:!0},description:{type:String},color:{type:String}}),a=o().models.Product||o().model("Products",n)},81755:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(56037),o=t.n(s);let n="mongodb+srv://rajkumar:Raj%409956@lebel.amqvplr.mongodb.net/lebelankasha?retryWrites=true&w=majority";if(!n)throw Error("Please define the MONGODB_URI");let a=global.mongoose;a||(a=global.mongoose={conn:null,promise:null});let i=async function(){return a.conn||(a.promise||(a.promise=o().connect(n,{bufferCommands:!1}).then(e=>(console.log("Connected database"),e))),console.log("Connection failed"),a.conn=await a.promise),a.conn}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,5452],()=>t(91661));module.exports=s})();